sparrow/
  graphics/
    __init__.py
    renderer/
      __init__.py
      graph.py              # RenderGraph + RenderPass base types
      pipeline.py           # Default forward+deferred pipelines
      frame.py              # FrameResources (gbuffer, hdr, etc)
      culling.py            # Frustum culling + draw list building
      batching.py           # Instancing / sprite batching helpers
      types.py              # Render enums, vertex formats, etc

    assets/
      __init__.py
      shaders.py            # ShaderLibrary / shader resolution policy
      materials.py          # Material + MaterialInstance
      meshes.py             # Mesh + MeshLibrary (quad, cube, etc)
      textures.py           # TextureRegistry (existing ids + loading)
      samplers.py           # Optional

    shaders/                # Engine-default shader sources live here
      __init__.py
      gbuffer_sprite.vert
      gbuffer_sprite.frag
      gbuffer_mesh.vert
      gbuffer_mesh.frag
      lighting_deferred.frag
      post_bloom.frag
      post_tonemap.frag
      post_chromatic.frag   # you already started this idea
      debug_normals.frag
      debug_depth.frag

  core/
    components.py           # Transform becomes full 3D; Sprite becomes light-weight
    world.py
    events.py

  systems/
    __init__.py
    render_collect.py       # optional: converts Sprite->Renderable
    render_system.py        # builds draw list, culls, runs graph



Phase 1: Introduce assets + render graph without changing visuals
  - [x] Add ShaderLibrary, MaterialLibrary, MeshLibrary resources
  - [x] Add engine shader folder and compile your existing shaders via library
  - [x] Wrap current renderer code into RenderGraph passes (still using existing shaders)
  - [x] Confirm game runs unchanged

Phase 2: Introduce Renderable and draw list building
  - [x] Add Renderable component
  - [x] Add sprite_to_renderable_system bridge
  - [x] Modify renderer to draw from Renderable not Sprite
  - [x] Confirm game runs unchanged

Phase 3: Upgrade Transform to 3D (careful but necessary)
  - [x] Replace Transform with pos/rot/scale
  - [x] Add conversion helpers so existing spawn APIs still work
  - [ ] Update renderer to use model matrices
  - [ ] Confirm game runs unchanged

Phase 4: Remove shader skew and move to transform rotation
  - [ ] Remove u_skew usage from sprite shaders
  - [ ] Apply pitch rotation via Transform for paper cutouts
  - [ ] Fix any “Y/Z leakage” permanently by eliminating ad-hoc matrix math

Phase 5: Add mesh rendering path for 3D walls
  - [ ] Add gbuffer_mesh shader (same GBuffer contract)
  - [ ] Add chunk mesher system for dungeon walls (optional initially: just make a cube mesh wall entity)
  - [ ] Replace dungeon walls from “sprite walls” to “mesh walls” later without changing renderer